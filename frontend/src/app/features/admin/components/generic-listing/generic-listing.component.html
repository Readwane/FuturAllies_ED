<div class="generic-listing-container">
    <!-- Barre de recherche -->
    <div class="search-toolbar">
      <mat-form-field appearance="outline" class="search-bar">
        <mat-label>Rechercher</mat-label>
        <input matInput [(ngModel)]="searchQuery" (keyup)="onSearchChange()" />
      </mat-form-field>
  
      <!-- Bouton Supprimer tout -->
      <div *ngIf="selectable && hasSelectedRows()" class="bulk-actions-toolbar">
        <button
          *ngFor="let action of bulkActions"
          mat-raised-button
          color="warn"
          (click)="executeBulkAction(action)"
        >
          {{ action.label }}
        </button>
      </div>
    </div>
  
    <!-- Tableau dynamique -->
    <table mat-table [dataSource]="paginatedData" class="listing-table mat-elevation-z8">
      <!-- Colonne de sélection -->
      <ng-container *ngIf="selectable" matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox
            (change)="toggleAllRows($event.checked)"
            [checked]="isAllSelected()"
            [indeterminate]="!isAllSelected() && hasSelectedRows()"
          ></mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let element">
          <mat-checkbox [(ngModel)]="element.selected" (change)="updateSelectedItems()"></mat-checkbox>
        </td>
      </ng-container>
  
      <!-- Colonnes dynamiques -->
      <ng-container *ngFor="let field of fieldsConfig" [matColumnDef]="field.name">
        <th mat-header-cell *matHeaderCellDef [class.actions-column-header]="field.type === 'actions'">
          {{ field.label }}
        </th>
        <td mat-cell *matCellDef="let element" [class.actions-cell]="field.type === 'actions'">
          <ng-container *ngIf="field.type !== 'actions'">
            {{ element[field.name] }}
          </ng-container>
          <ng-container *ngIf="field.type === 'actions'">
            <button
              *ngFor="let action of actions"
              mat-icon-button
              [matTooltip]="action.label"
              (click)="executeAction(action, element)"
            >
              <mat-icon [class]="action.icon">{{ action.icon }}</mat-icon>
            </button>
          </ng-container>
        </td>
      </ng-container>
  
      <!-- Lignes et en-têtes -->
      <tr mat-header-row *matHeaderRowDef="allColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: allColumns"
        (click)="handleRowClick(row)"
        class="clickable-row"
      ></tr>
    </table>
  
    <!-- Pagination -->
    <mat-paginator
      *ngIf="paginationConfig"
      [length]="data.length"
      [pageSize]="paginationConfig.pageSize"
      [pageSizeOptions]="paginationConfig.pageSizeOptions"
      (page)="onPageChange($event)"
    >
    </mat-paginator>
  
    <!-- Bouton flottant pour ajouter une ressource -->
    <button
      *ngIf="addEvent"
      mat-fab
      color="primary"
      class="add-resource-button"
      (click)="onAddClick()"
    >
      <mat-icon>add</mat-icon>
    </button>
  </div>
  